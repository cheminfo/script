
var list=['00000', '00002', '00003', '00004', '00005', '00006', '00007', '00008', '00009', '00010', '00012', '00015', '00016', '00017', '00018', '00019', '00020', '00021', '00022', '00023', '00025', '00026', '00027', '00029', '00031', '00033', '00036', '00038', '00039', '00042',
      '00043', '00045', '00046', '00047', '00048', '00049', '00050', '00051', '00052', '00053', '00054', '00055', '00057', '00058', '00059', '00060', '00061', '00062', '00064', '00065', '00067', '00068', '00069', '00070', '00071', '00072', '00073', '00076', '00077', '00078',
      '00079', '00080', '00081', '00083', '00084', '00085', '00086', '00087', '00088', '00090', '00093', '00094', '00095', '00096', '00097', '00098', '00100', '00102', '00103', '00104', '00105', '00107', '00109', '00110', '00111', '00112', '00113', '00115', '00116', '00117',
      '00118', '00120', '00121', '00122', '00123', '00124', '00125', '00126', '00127', '00128', '00129', '00130', '00131', '00132', '00133', '00135', '00136', '00137', '00138', '00139', '00140', '00143', '00145', '00146', '00147', '00148', '00149', '00150', '00152', '00153',
      '00154', '00155', '00156', '00157', '00158', '00159', '00160', '00161', '00162', '00164', '00165', '00166', '00167', '00168', '00169', '00171', '00172', '00173', '00174', '00175', '00176', '00177', '00178', '00179', '00180', '00181', '00182', '00183', '00184', '00185',
      '00186', '00187', '00188', '00189', '00190', '00191', '00192', '00193', '00194', '00195', '00196', '00198', '00200', '00201', '00202', '00204', '00205', '00207', '00208', '00209', '00210', '00212', '00213', '00214', '00215', '00217', '00218', '00219', '00220', '00221',
      '00222', '00224', '00225', '00226', '00227', '00228', '00229', '00230', '00231', '00232', '00234', '00235', '00236', '00238', '00239', '00240', '00241', '00242', '00243', '00244', '00245', '00246', '00247', '00248', '00249', '00250', '00251', '00252', '00253', '00254',
     '00255', '00256', '00257', '00258', '00259', '00260', '00261', '00262', '00263', '00264', '00267', '00268', '00269', '00271', '00272', '00273', '00274', '00275', '00276', '00277', '00278', '00280', '00281', '00282', '00283', '00284', '00285', '00286', '00287', '00288',
      '00290', '00291', '00292', '00293', '00294', '00295', '00297', '00298', '00299', '00300'];
//list=['00000','00003','00179'];
//path to the simulated spectra
var labels=new Array();
var spectraData=new Array();
var url='http://localhost:8080/servletScript/spectra/1H/';
var urls = new Array();
var ind=0;
var spectrum;
for(var mol=0;mol<list.length;mol++){
	for(var i=0;i<10;i++){
		//Store an array representation of the spectrum in a vector
		urls[ind]=url+list[mol]+'/spinus_'+i+'.jdx';
		spectrum=SD.loadJCamp(urls[ind]);
		spectraData[ind++]=spectrum.getEquallySpacedDataInt(0, 10, 1024);
	}
}

//Creating the similarity matrix
var similarity = new Array();
for (var i=0;i<ind;i=i+1) {
	similarity[i]=new Array();
}
//Calculating similarities...
for (var i=0;i<ind;i=i+1) {
	for (var j=i;j<ind;j=j+1) {
		similarity[i][j]=1-Distance.treeSimilarity(spectraData[i],spectraData[j]);
		similarity[j][i]=similarity[i][j];
	}
}

//Labels depending on the molecule		
var labels=new Array(ind);
var cont=0;
for(var mol=0;mol<list.length;mol++){
	for(var i=0;i<10;i++){
		labels[cont]=list[mol]+'_'+i+'\t'+list[mol]+'\t'+urls[cont++];
	}
}

//Create the dendrogram	
var dendrogram = Distance.clustering(similarity,labels);
//Return to the client the JSON of the dendrogram
jexport('dendrogram',dendrogram,'dendrogram'); 
jexport('distance',similarity,'matrix');